{% metadata_file .yamato/global.metafile %}
---

# This file is only used within Unity to deploy to the package manager.
#
# When Autodesk releases a new version of FBX SDK, to update the pacakge to it:
# 1) Create a branch of the repo like "update-to-2020-3-4"
# 2) Create the folder fbxsdk_to_upload at the root of the repo.
# 3) Push the branch.
# 4) On each platform:
#    a) install FBX SDK using the installer
#    b) pull the branch
#    c) windows:
#         py -3 .yamato/zip-fbxsdk.py "/c/Program Files/Autodesk/FBX/FBX SDK/2020.3.4"
#         git commit fbxsdk_to_upload/fbxsdk-win-x64.7z
#    d) mac:
#         python .yamato/zip-fbxsdk.py "/Applications/Autodesk/FBX SDK/2020.3.4"
#         git commit fbxsdk-mac-x64.7z
#    e) linux: ... similar, just figure out where FBX SDK ends up.
# 5) manually run the yamato job on this branch, and set fbxsdk_version correctly
#     e.g. 2020.3.4
# 6) check the logs to find the upload name including GUID & update the
#    CMakeLists.txt stevedore jobs accordingly
#
# Revert to 22a593b45e074c1bc9e7095e958ae4a5d7376a5a to get the legacy
# behaviour used before FBX SDK 2020.3.4 (you would lose win/arm64 and gain mac/intel/10.13)
#
upload_fbxsdk_to_stevedore:
  name: Upload FBXSDK {{ fbxsdk_version }} to Stevedore testing repository
  agent:
    type: {{ ubuntu_platform.type }}
    image: {{ ubuntu_platform.image }}
    flavor: {{ ubuntu_platform.flavor}}
  commands:
    - curl -sSo StevedoreUpload $STEVEDORE_UPLOAD_TOOL_LINUX_X64_URL
    - chmod +x StevedoreUpload
    - ./StevedoreUpload --repo=testing --version={{ fbxsdk_version }}-VS2019 fbxsdk_to_upload/fbxsdk-win-x64.7z
    - ./StevedoreUpload --repo=testing --version={{ fbxsdk_version }} fbxsdk_to_upload/fbxsdk-linux-x64.7z
    - ./StevedoreUpload --repo=testing --version={{ fbxsdk_version }} fbxsdk_to_upload/fbxsdk-mac-x64.7z
  artifacts:
    artifacts_to_upload:
      paths:
        - "fbxsdk/**/*"
